const adminUrl=window.location.href.replace("auth-frame/",""),siteOrigin="http://localhost:2368";window.addEventListener("message",(async function(i){if(i.origin!==siteOrigin)return void console.warn("Ignored message to admin auth iframe because of mismatch in origin","expected",siteOrigin,"got",i.origin,"with data",i.data);let t=null;try{t=JSON.parse(i.data)}catch(i){console.error(i)}function n(n,a){i.source.postMessage(JSON.stringify({uid:t.uid,error:n,result:a}),siteOrigin)}if("getUser"===t.action)try{const i=await fetch(adminUrl+"api/canary/admin/users/me/");n(null,await i.json())}catch(i){n(i,null)}if("hideComment"===t.action)try{const i=await fetch(adminUrl+"api/canary/admin/comments/"+t.id+"/",{method:"PUT",body:JSON.stringify({comments:[{id:t.id,status:"hidden"}]}),headers:{"Content-Type":"application/json"}});n(null,await i.json())}catch(i){n(i,null)}if("showComment"===t.action)try{const i=await fetch(adminUrl+"api/canary/admin/comments/"+t.id+"/",{method:"PUT",body:JSON.stringify({comments:[{id:t.id,status:"published"}]}),headers:{"Content-Type":"application/json"}});n(null,await i.json())}catch(i){n(i,null)}}));